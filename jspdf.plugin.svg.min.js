/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2022 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */

(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?factory(exports):typeof define==="function"&&define.amd?define(["exports"],factory):(global=typeof globalThis!=="undefined"?globalThis:global||self,factory(global.svg={}))})(this,function(exports){"use strict";var _addSvgContent=function(element,target){var children=element.childNodes;for(var i=0;i<children.length;i++){var node=children[i];var type=node.nodeType;if(type===1){var tagName=node.nodeName.toLowerCase();if(tagName==="defs"||tagName==="clippath"||tagName==="pattern"||tagName==="marker"){continue}if(tagName==="svg"){_addSvgContent(node,target);continue}var child=target.appendChild(node.cloneNode(false));_addSvgContent(node,child)}else if(type===3){target.appendChild(node.cloneNode(false))}}};var _copySvgContent=function(element){var svg=element.cloneNode(false);_addSvgContent(element,svg);return svg};var _embedImages=function(element,callback){var images=element.getElementsByTagName("image");var remaining=images.length;if(remaining===0){callback()}Array.prototype.forEach.call(images,function(image){var href=image.getAttribute("href")||image.getAttribute("xlink:href");if(href){var canvas=document.createElement("canvas");var ctx=canvas.getContext("2d");var img=new Image;img.onload=function(){canvas.width=img.width;canvas.height=img.height;ctx.drawImage(img,0,0);image.setAttribute("href",canvas.toDataURL("image/png"));remaining--;if(remaining===0){callback()}};img.src=href}else{remaining--;if(remaining===0){callback()}}})};var _getSvgDimensions=function(element){var widthAttr=element.getAttribute("width");var heightAttr=element.getAttribute("height");var viewBoxAttr=element.getAttribute("viewBox");var width=parseFloat(widthAttr||0);var height=parseFloat(heightAttr||0);if(viewBoxAttr){var values=viewBoxAttr.split(" ").map(parseFloat);if(!width&&!height){width=values[2];height=values[3]}}return{width:width,height:height}};var _prepareSvg=function(element,options,callback){_embedImages(element,function(){var svg=_copySvgContent(element);var dimensions=_getSvgDimensions(element);svg.setAttribute("width",dimensions.width);svg.setAttribute("height",dimensions.height);callback(svg.outerHTML)})};var addSvg=function(svg,x,y,options){var _this=this;options=options||{};if(typeof svg==="string"){svg=new DOMParser().parseFromString(svg,"image/svg+xml").documentElement}_prepareSvg(svg,options,function(svgContent){var dimensions=_getSvgDimensions(svg);var width=options.width||dimensions.width;var height=options.height||dimensions.height;_this.addSvgAsImage(svgContent,x,y,width,height)})};exports.addSvg=addSvg;Object.defineProperty(exports,"__esModule",{value:true})});